# region 基本功能
_NUM:
  AS_WORD:
    BODY:
      VAL: "@" #就地代入实际值
      STOP: VAL

年:
  AS_WORD: #用于分词后的第一步解析，从词解析为形式结构
    BODY: &yrb
      DESC: 年
      STOP:
        - VAL
        - DESC
  AS_STRUCT: &yrs #用于第二步解析，从形式结构解析为具有实际值的结构
    META:
      ID: YR
      STEP:
        PERC: YR
        AMP: 1

明年:
  AS_WORD:
    BODY:
      MOD: 1
      <<: *yrb
  AS_STRUCT:
    <<: *yrs

月: &month
  AS_WORD:
    BODY:
      DESC: 月
      STOP:
        - VAL
        - DESC
  AS_STRUCT:
    META: &month_meta
      ID: MO
      STEP:
        PERC: MO
        AMP: 1

月份:
  <<: *month

日: &day
  AS_WORD:
    BODY:
      DESC: 日
      STOP:
        - VAL
        - DESC
  AS_STRUCT:
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

号:
  <<: *day

天:
  <<: *day

周: &week
  AS_WORD:
    BODY:
      DESC: 周
      STOP:
        - VAL
        - DESC
    META:
      ID: WK
      STEP:
        PERC: DA
        AMP: 7
      CYCL:
        PERIOD: 1

星期:
  <<: *week

时: &hour
  AS_WORD:
    BODY:
      DESC: 时
      STOP:
        - VAL
        - DESC
  AS_STRUCT:
    META:
      ID: HR
      STEP:
        PERC: HR
        AMP: 1

点:
  <<: *hour

小时:
  <<: *hour

分: &minute
  AS_WORD:
    BODY:
      DESC: 分
      STOP:
        - VAL
        - DESC
  AS_STRUCT:
    META:
      ID: MI
      STEP:
        PERC: MI
        AMP: 1

分钟:
  <<: *minute

秒:
  AS_WORD:
    BODY:
      DESC: 秒
      STOP: ALL
  AS_STRUCT:
    META:
      ID: SC
      STEP:
        PERC: SC
        AMP: 1

/:
  AS_WORD:
    BODY:
      DESC: SEP
    STOP: ALL #STOP ALL表示停止整个STRUCT

"-":
  AS_WORD:
    BODY:
      DESC: SEP
    STOP: ALL

_:
  AS_WORD:
    BODY:
      DESC: SEP
    STOP: ALL

".":
  AS_WORD:
    BODY:
      DESC: SEP
    STOP: ALL

"：":
  AS_WORD:
    BODY:
      DESC: SEP
    STOP: ALL

" ": null

世纪:
  AS_WORD:
    BODY:
      DESC: 世纪
      STOP: ALL
  AS_STRUCT:
    META:
      ID: CT
      STEP:
        PERC: CT
        AMP: 1

年代:
  AS_WORD:
    BODY:
      DESC: 年代
      STOP: ALL
  AS_STRUCT:
    META:
      ID: YR
      STEP:
        PERC: YR
        AMP: 10

":":
  AS_WORD:
    BODY:
      DESC: "HR_OR_MI"
      STOP: ALL

下午: &pm
  AS_WORD:
    BODY:
      VAL: 13 #此处放一个VAL为了防止它被合并进它的上一个STRUCT里，同时不进行STOP使得下一个VAL可以覆盖它
      MOD: 12

晚上:
  AS_WORD:
    BODY:
      VAL: 5
      MOD: 12
    META:
      ID: HR
      STEP:
        PERC: HR
        AMP: 6

PM:
  <<: *pm

半:
  AS_WORD:
    BODY:
      DESC: 半

个半月: #解析为“月半”，只把它单拎出来是因为我好像就能想到“x个半月”这种表述里面“半”在前面
  AS_WORD:
    BODY:
      DESC: 半 #此处DESC为“半”是为了能让模板把它解析出半个月来
      STOP: DESC
    META: #因为没有“月”作为desc了所以需要在这里加一个meta
      <<: *month_meta

中午:
  AS_WORD:
    BODY:
      VAL: 12
      DESC: 时
      MOD: "val+12 if val <= 3 else val"

午夜: &midnight
  AS_WORD:
    BODY:
      VAL: 0
      DESC: 时
      MOD: "val if val <= 3 else val+12"

半夜:
  <<: *midnight

上午: null

凌晨:
  AS_WORD:
    BODY:
      VAL: 0
      DESC: 凌晨
  AS_STRUCT:
    META:
      STEP:
        PERC: HR
        AMP: 5

明天:
  AS_WORD:
    BODY:
      MOD: 1
      STOP: ALL
      DESC: 日

今天:
  AS_WORD:
    BODY:
      MOD: 0
      STOP: ALL
      DESC: 日

今年:
  AS_WORD:
    BODY:
      MOD: 0
      STOP: ALL
      DESC: 年

昨天:
  AS_WORD:
    BODY:
      MOD: -1
      STOP: ALL
      DESC: 日

前天:
  AS_WORD:
    BODY:
      MOD: -2
      STOP: ALL
      DESC: 日

大前天:
  AS_WORD:
    BODY:
      MOD: -3
      STOP: ALL
      DESC: 日

后天:
  AS_WORD:
    BODY:
      MOD: 2
      STOP: ALL
      DESC: 日

大后天:
  AS_WORD:
    BODY:
      MOD: 3
      STOP: ALL
      DESC: 日

公历: null

下个: &next
  AS_WORD:
    BODY:
      MOD: "val + (struct.meta and struct.meta.cycl and struct.meta.cycl.period or struct.meta.step and struct.meta.step.amp or 1)"
      STOP: VAL

下:
  <<: *next

上个: &prev
  AS_WORD:
    BODY:
      MOD: "val - (struct.meta and struct.meta.cycl and struct.meta.cycl.period or struct.meta.step and struct.meta.step.amp or 1)"
      STOP: VAL

上:
  <<: *prev

后: &after
  AS_WORD:
    BODY:
      MOD: "'#after' and val" #MOD字段也可以当自定义标签使用
      STOP: ALL
    META:
      STEP:
        AMP: 1 #xx前/后一般指的是特定的一天/月/年等

以后:
  <<: *after

前: &before
  AS_WORD:
    BODY:
      MOD: "'#before' and val"
      STOP: ALL
    META:
      STEP:
        AMP: 1

以前:
  <<: *before

去年:
  AS_WORD:
    BODY:
      MOD: -1
      STOP: ALL
      DESC: 年

前年:
  AS_WORD:
    BODY:
      MOD: -2
      STOP: ALL
      DESC: 年

整:
  AS_WORD:
    BODY:
      VAL: 0
      STOP: ALL

周一: &WDmon
  AS_WORD:
    BODY:
      MOD: "val-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期一:
  <<: *WDmon

周二: &WDtue
  AS_WORD:
    BODY:
      MOD: "val+1-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期二:
  <<: *WDtue

周三: &WDwed
  AS_WORD:
    BODY:
      MOD: "val+2-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期三:
  <<: *WDwed

周四: &WDthu
  AS_WORD:
    BODY:
      MOD: "val+3-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期四:
  <<: *WDthu

周五: &WDfri
  AS_WORD:
    BODY:
      MOD: "val+4-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期五:
  <<: *WDfri

周六: &WDsat
  AS_WORD:
    BODY:
      MOD: "val+5-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期六:
  <<: *WDsat

周日: &WDsun
  AS_WORD:
    BODY:
      MOD: "val+6-datetime.date(year=Cdatum.year,month=Cdatum.month,day=Cdatum.day).weekday()"
      DESC: weekday
      STOP: ALL

星期日:
  <<: *WDsun

周天:
  <<: *WDsun

星期天:
  <<: *WDsun

weekday:
  AS_STRUCT:
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1
      CYCL:
        PERIOD: 7

嘉靖: #没错我就是面向测试用例编程怎么了.jpg
  AS_WORD:
    DATUM:
      year: 1521
    BODY:
      MOD: 1521

元旦:
  AS_WORD:
    EXPAND:
      - STRUCT:
          BODY:
            VAL: 1
          META:
            ID: MO
      - STRUCT:
          BODY:
            VAL: 1
          META:
            ID: DA
            STEP:
              PERC: DA
              AMP: 1
          STOP: ALL

农历:
  AS_WORD:
    DATUM:
      lunar: true

正月:
  AS_WORD:
    BODY:
      VAL: 1
      DESC: 月
      STOP:
        - VAL
        - DESC
    DATUM:
      lunar: true

冬月:
  AS_WORD:
    BODY:
      VAL: 11
      DESC: 月
      STOP:
        - VAL
        - DESC
    DATUM:
      lunar: true

腊月:
  AS_WORD:
    BODY:
      VAL: 12
      DESC: 月
      STOP:
        - VAL
        - DESC
    DATUM:
      lunar: true

闰:
  AS_WORD:
    BODY:
      MOD: "-val" #用负数表示闰月
    DATUM:
      lunar: true

初一:
  AS_WORD:
    BODY:
      VAL: 1
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初二:
  AS_WORD:
    BODY:
      VAL: 2
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初三:
  AS_WORD:
    BODY:
      VAL: 3
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初四:
  AS_WORD:
    BODY:
      VAL: 4
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初五:
  AS_WORD:
    BODY:
      VAL: 5
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初六:
  AS_WORD:
    BODY:
      VAL: 6
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初七:
  AS_WORD:
    BODY:
      VAL: 7
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初八:
  AS_WORD:
    BODY:
      VAL: 8
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初九:
  AS_WORD:
    BODY:
      VAL: 9
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

初十:
  AS_WORD:
    BODY:
      VAL: 10
      STOP: VAL
    DATUM:
      lunar: true
    META:
      ID: DA
      STEP:
        PERC: DA
        AMP: 1

春节:
  AS_WORD:
    EXPAND:
      - STRUCT:
          BODY:
            VAL: 1
            DESC: 月
          DATUM:
            lunar: true
      - STRUCT:
          BODY:
            VAL: 1
            DESC: 日
          DATUM:
            lunar: true
